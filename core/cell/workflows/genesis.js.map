{"version":3,"file":"genesis.js","sourceRoot":"","sources":["../../../../src/core/cell/workflows/genesis.ts"],"names":[],"mappings":"AAEA,OAAO,EACL,uBAAuB,EACvB,WAAW,EACX,QAAQ,EACR,QAAQ,GACT,MAAM,iCAAiC,CAAC;AACzC,OAAO,EAAE,UAAU,EAAE,MAAM,qBAAqB,CAAC;AACjD,OAAO,EAAE,oBAAoB,EAAE,MAAM,mBAAmB,CAAC;AAEzD,MAAM,CAAC,MAAM,OAAO,GAAG,CACrB,OAAoB,EACpB,OAAa,EACb,cAAmB,EACnB,EAAE,CAAC,KAAK,EAAE,IAAU,EAAiB,EAAE;IACvC,MAAM,GAAG,GAAG,QAAQ,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;IACvC,UAAU,CAAC,EAAE,aAAa,EAAE,QAAQ,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAE3E,MAAM,GAAG,GAAG,uBAAuB,CAAC,IAAI,CAAC,KAAK,EAAE,cAAc,CAAC,CAAC;IAChE,UAAU,CAAC,EAAE,aAAa,EAAE,QAAQ,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAE3E,MAAM,KAAK,GAAU;QACnB,OAAO,EAAE,OAAO;QAChB,UAAU,EAAE,OAAO;KACpB,CAAC;IACF,MAAM,0BAA0B,GAAG,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;IAC3E,UAAU,CAAC;QACT,aAAa,EAAE,QAAQ,CAAC,0BAA0B,CAAC;QACnD,KAAK,EAAE,KAAK;KACb,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAEf,IAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC,CAAC;AACnD,CAAC,CAAC","sourcesContent":["import { AgentPubKey, Hash, Entry } from '@holochain-open-dev/core-types';\nimport { Cell } from '../../cell';\nimport {\n  buildAgentValidationPkg,\n  buildCreate,\n  buildDna,\n  buildShh,\n} from '../source-chain/builder-headers';\nimport { putElement } from '../source-chain/put';\nimport { produce_dht_ops_task } from './produce_dht_ops';\n\nexport const genesis = (\n  agentId: AgentPubKey,\n  dnaHash: Hash,\n  membrane_proof: any\n) => async (cell: Cell): Promise<void> => {\n  const dna = buildDna(dnaHash, agentId);\n  putElement({ signed_header: buildShh(dna), entry: undefined })(cell.state);\n\n  const pkg = buildAgentValidationPkg(cell.state, membrane_proof);\n  putElement({ signed_header: buildShh(pkg), entry: undefined })(cell.state);\n\n  const entry: Entry = {\n    content: agentId,\n    entry_type: 'Agent',\n  };\n  const create_agent_pub_key_entry = buildCreate(cell.state, entry, 'Agent');\n  putElement({\n    signed_header: buildShh(create_agent_pub_key_entry),\n    entry: entry,\n  })(cell.state);\n\n  cell.triggerWorkflow(produce_dht_ops_task(cell));\n};\n"]}